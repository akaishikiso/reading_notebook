# プロになるための Web 技術入門
## HTTPを知る

### HTTPの知識はなぜ必要か
- HTTP通信：OSI参照モデル上位３層

- WWW：ネットワーク上にリンクされたハイパーリンクの繋がりのこと
    - ハイパーリンク：コンピュータに理解できる形式
    - ハイパーテキスト：ファイル同士をハイパーリンクを用いて非線形的に関連づけられる仕組み
    - HTML：ハイパーテキストを書ける言語

- HTTP：WWWの世界でHTMLをやり取りするために定められたプロトコル

### WebブラウザとWebサーバの通信

https://www.youtube.com/youtubei/v1/account/get_setting_values?prettyPrint=false

TCP/IPが送受信するもの
- HTTP
- SMTP　POP3　メール
- SSH　遠隔操作

```

:authority:　www.youtube.com　→リクエストの送信先ホスト名やポート番号
:method:　POST
:path:　/youtubei/v1/account/get_setting_values?prettyPrint=false
:scheme:　https
accept:　*/*
→Webクライアントが受け取ることのできるデータの種類。　*/*は任意の情報を受け取れる
accept-encoding:　gzip, deflate, br, zstd
accept-language:　ja,en-US;q=0.9,en;q=0.8
authorization:　SAPISIDHASH 1750496985_fd14c3f7b7b03c69e25dd129535386c1b1dc0ce3_u SAPISID1PHASH 1750496985_fd14c3f7b7b03c69e25dd129535386c1b1dc0ce3_u SAPISID3PHASH 1750496985_fd14c3f7b7b03c69e25dd129535386c1b1dc0ce3_u
content-length:　4111
content-type:　application/json
cookie:　`HSID=AjlTKSuHb9aHWYNLM; SSID=AvJRgxSYjPwJoxTjd; APISID=PolI-eqQVigMdURK/AdJsatZ5-7w65vxsn; SAPISID=Zyj_afFkZmrjxm6_/Au7939dpdDR8zBr-o; __Secure-1PAPISID=Zyj_afFkZmrjxm6_/Au7939dpdDR8zBr-o; __Secure-3PAPISID=Zyj_afFkZmrjxm6_/Au7939dpdDR8zBr-o; LOGIN_INFO=AFmmF2sw`
```

- URL：インターネット上に存在するリソースの位置を指定するためのもの　位置情報
- URN：インターネット上に存在する名前を一意に識別するために用意されたもの　名前
- URI：URL（位置情報）とURN（名前）を統一的に表現したもの

#### ステータスコード
```
100番台：Informational（処理中）

200番台：Success（成功）

300番台：Redirection（さらに動作が必要）

400番台：Client Error（お前が悪い）

500番台：Server Error（相手が悪い）
```

#### 代表的なステータスコード
```
200　OK　
（GET: リソースが読み込まれ、メッセージ本文で転送された。
PUT または POST: 操作の結果を表すリソースがメッセージ本文で送信される。）

201　Created（
リクエストは成功し、その結果新たなリソースが作成されたことを示します。これは一般的に、 POST リクエストや、一部の PUT リクエストを送信した後のレスポンスになります。）

204　No Content
（リクエストに対して送信するコンテンツはありませんが、ヘッダーは有用であることを示します。ユーザーエージェントはこのリソースに関するキャッシュ済みのヘッダーを、新たな内容に更新します。）

301　Moved Permanently
（リクエストされたリソースの URL が永遠に変更されたことを示します。レスポンスで新しい URL が与えられます。）

307　Temporary Redirect
（サーバーはこのレスポンスを、リクエストされたリソースを別の URI で、元のリクエストと同じメソッドを使用して取得するようクライアントを誘導するために送信します。 これは 302 Found HTTP レスポンスコードと同じ意味を持ちますが、ユーザーエージェントは使用する HTTP メソッドを変更してはならない点が異なります。始めのリクエストで POST を用いた場合は、次のリクエストでも POST を使用しなければなりません）

400　Bad Request（クライアントのエラーとみなされるもの（例えば、不正なリクエスト構文、不正なリクエストメッセージフレーム、不正なリクエストルーティング）のために、 サーバーがリクエストを処理できない、あるいは処理しようとしない場合を示します。）

401　Unauthorized
（HTTP 標準では "unauthorized" (不許可) と定義されていますが、意味的にはこのレスポンスは "unauthenticated" (未認証) です。 つまり、クライアントはリクエストされたレスポンスを得るためには認証を受けなければなりません。）

403　Forbidden
（認証されていないなどの理由でクライアントにコンテンツのアクセス権がなく、サーバーが適切なレスポンスの返信を拒否していることを示します。 401 Unauthorized とは異なり、クライアントの ID がサーバーに知られています。）

404　Not Found
（サーバーがリクエストされたリソースを発見できないことを示します。 ブラウザーでは、これは URL が解釈できなかったことを意味します。 API では、これは通信先が有効であるものの、リソース自体が存在しないことを意味することがあります。 サーバーは認証されていないクライアントからリソースの存在を隠すために、 403 Forbidden の代わりにこのレスポンスを返すことがあります。 ）

500　Internal Server Error
（サーバー側で処理方法がわからない事態が発生したことを示します。 このエラーは汎用的なエラーで、サーバーが応答に適切な 5XX ステータスコードを見つけることができないことを示しています。）

502 Bad Gateway
このエラーレスポンスは、リクエストの処理に必要なレスポンスを受け取るゲートウェイとして動作するサーバーが無効なレスポンスを受け取ったことを示します。

503 Service Unavailable
サーバーはリクエストを処理する準備ができていないことを示します。 一般的な原因は、サーバーがメンテナンスや過負荷でダウンしていることです。 このレスポンスとともに問題について説明する、ユーザーにわかりやすいページを送信するべきであることに注意してください。 このレスポンスは一時的な状況について使用するものであり、また可能であれば、サービスが復旧する前に HTTP の Retry-After ヘッダーに予定時刻を含めてください。 また、これら一時的な状況のレスポンスは通常キャッシュされるべきではないことから、ウェブ管理者はこのレスポンスとともに送られるキャッシュ関連のヘッダーに注意しなければなりません。
```

### 情報はどうやってインターネットの大海原を越えるのか

- IPアドレス:コンピュータの識別子
    - グローバルIPアドレス：ISPによって割り当てられるやつ。重複しない
    - プライベートIPアドレス：ある一定範囲内のIPアドレスをプライベートネットワーク内で自由に利用できる。電話の内線番号みたいなやつ
- TCP/IP: IPアドレスをもとにパケットデータを送受信するプロトコル。HTTPリクエストなどの情報の分割や、パケットからの再構築を行う
- DNS：ドメイン名とIPアドレスの対応表を持ったコンピュータをインターネット上に配置しておき、DNSサーバに問い合わせたらドメイン名に対応するIPアドレスを教えてもらえるもの

### GETとPOSTの違い
- GET:クエリ文字列で値を渡す
1. 同じ要求を何度繰り返しても同じ結果が得られる＝副作用がない
2. パラメータの保存がしやすい
- POST:リクエストボディで値を渡す
1. リクエストの内容をURLから判別できない
2. 長さの制限がない

クエリ文字列に日本語を渡したい場合→文字化けしないようにパーセントエンコー


## Webサーバへの要求をどのように伝えるか

### リダイレクトの仕組み
最初に要求したURLとは異なるURLへ誘導することを「リダイレクト」という

3つのリクエスト
1. login.htmlの表示リクエスト
2. ログインボタンを押した時のログイン操作のリクエスト
3. リダイレクト先への表示リクエスト
ブラウザは、302のリクエストを受け取ると、再度指定のURLに対してリクエストを発行する

### アプリケーションによる認証機能の実現方法

1. ログインページで、POSTメソッドを使ってログイン情報を送信→認証すると302
2.  リダイレクト先で、GETメソッドを使ってログイン後に閲覧できる情報を取得

### ステートフルなプロトコルとステートレスなプロトコルの違い
ログイン状態をチェックしないといけない。
しかしHTTPでは、「状態」を持つことができない→ **「ステートレスなプロトコル」**

FTP（ファイル転送プロトコル）：ユーザ名とパスワードを通知してから、必要な手続きを踏む必要がある→ **「ステートフルなプロトコル」**

### Cookieの考え方と実現方法
HTTPはステートレス。→**Cookie**で状態を保持する

youtubeのホーム画面にアクセスした時のヘッダ。ログイン済
```
cookie:　HSID=AjlTKSuHb9aHWYNLM; SSID=AvJRgxSYjPwJoxTjd; APISID=PolI-eqQVigMdURK/AdJsatZ5-7w65vxsn; SAPISID=Zyj_afFkZmrjxm6_/Au7939dpdDR8zBr-o; __Secure-1PAPISID=Zyj_afFkZmrjxm6_/Au7939dpdDR8zBr-o; __Secure-3PAPISID=Zyj_afFkZmrjxm6_/Au7939dpdDR8zBr-o; LOGIN_INFO=AFmmF2sw....
```
はじめてアクセスした時、WebサーバはCookieをWebブラウザに渡す。受け取ったブラウザは、次回同じWebサーバにアクセスする際、受け取ったCookieをそのままHTTPリクエストのヘッダに入れて送る。
Webアプリケーション側では、リクエストヘッダに入っているCookieを調べることで、アクセスしてきた相手がどのような相手なのか知ることができる

### セッションの考え方と実現方法

Cookieは誰でも見ることができる。個人情報や金銭に関わる情報をCookieで保存することはセキュリティ的に大問題。

→より安全に多くの情報を保持するために**セッション**を用いる。

セッション：一連の業務の流れ

業務についての受付番号「セッションID」で、各処理の進行状況を管理する

CookieでセッションIDを渡す。ブラウザからもらったセッションIDをもとにクライアントの状態を探しに行く

→個人情報ではないので安全性が高い。情報量が少ない

セッションを利用したログイン認証の流れ
1. ユーザ名、パスワードで認証チェック
2. セッションIDを発行して、セッション情報にログイン中ユーザーを記録
3. CookieにセッションIDを格納して返す
4. セッションIDを格納したCookieを受け取る
5. セッションIDからログイン中ユーザを識別する

Basic認証
HTTPの使用の一部として規定されている認証機構。

メリット：Webサーバによって提供されており、ブラウザの設定をするだけで実現できる

デメリット：ユーザごとのロール設定や、セッションとの連携など、複雑な制御を行えない。パスワードが平文で送信されるため単独では安全性が低い


## Webアプリケーションの構成要素
### Webサーバの必要性と役割
ブラウザからのHTTPリクエストを受け取り、HTTPレスポンスを返すもの

### データベースサーバの必要性と役割
新しい値の登録時や既存の値の更新時も、WebアプリケーションのHTMLを修正することなくデータを提供できる。

DBサーバを分離することで、Webサーバの負荷を下げることができる

- Oracle DB
- Microsoft SQL Server
- PostgreSQL
- MySQL

### アプリケーションサーバの必要性と役割

### Webアプリケーションを効率よく開発するための仕組み
